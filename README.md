# 银行管理系统

基于Python和MySQL的完整银行管理系统，实现了银行业务的核心功能。

## 项目架构

### 系统架构图
```
┌─────────────────────────────────────────────────────────────┐
│                    银行管理系统                              │
├─────────────────────────────────────────────────────────────┤
│  BankSystem.py (主系统控制器)                               │
│  ├── 管理员模块                                             │
│  └── 客户模块                                               │
├─────────────────────────────────────────────────────────────┤
│                    业务服务层                               │
│  ├── CustomerService.py    (客户服务)                       │
│  ├── CardService.py        (银行卡服务)                     │
│  ├── DepositService.py     (存款服务)                       │
│  ├── TransactionService.py (交易服务)                       │
│  └── ReportService.py      (报表服务)                       │
├─────────────────────────────────────────────────────────────┤
│                    基础设施层                               │
│  ├── BaseService.py        (基础服务类)                     │
│  ├── DatabaseConnector.py  (数据库连接)                     │
│  └── DatabaseInitializer.py (数据库初始化)                  │
├─────────────────────────────────────────────────────────────┤
│                    数据库层                                 │
│  ├── 数据表 (userInfo, cardInfo, tradeInfo, etc.)          │
│  ├── 视图 (customer_card_view, transaction_detail_view)     │
│  ├── 触发器 (after_card_balance_update)                     │
│  └── 存储过程 (process_transfer)                            │
└─────────────────────────────────────────────────────────────┘
```

### 文件结构
```
bankManage/
├── BankSystem.py           # 主程序入口，系统控制器（命令行版本）
├── BankSystemGUI.py        # GUI主界面程序（图形界面版本）
├── BankSystemGUI_Extended.py # GUI扩展功能模块
├── DatabaseConnector.py    # 数据库连接管理，自动建表
├── BaseService.py          # 基础服务类，提供通用功能
├── CustomerService.py      # 客户信息管理服务
├── CardService.py          # 银行卡管理服务
├── DepositService.py       # 存款类型管理服务
├── TransactionService.py   # 交易记录管理服务
├── ReportService.py        # 报表生成服务
├── DatabaseInitializer.py  # 数据库初始化，创建视图触发器
├── requirements.txt        # Python依赖包列表
├── README.md              # 项目说明文档
├── 数据源2.txt            # 原始数据库脚本（参考）
└── 触发器.txt             # 原始触发器脚本（参考）
```

## 代码运行流程

### 1. 系统启动流程
```
1. 运行 python BankSystem.py
2. 初始化 DatabaseConnector，连接MySQL
3. 自动检查并创建数据库表
4. 插入初始测试数据（如果表为空）
5. 初始化 DatabaseInitializer
6. 创建视图、触发器、存储过程
7. 启动主菜单界面
```

### 2. 数据库自动初始化流程
```
DatabaseConnector.connect()
├── 连接MySQL数据库
├── _create_tables_if_not_exist()
│   ├── 创建 userInfo 表
│   ├── 创建 deposit 表
│   ├── 创建 cardInfo 表
│   ├── 创建 tradeInfo 表
│   └── 创建 Report 表
├── _insert_initial_data()
│   ├── 插入存款类型数据
│   ├── 插入测试客户数据
│   └── 插入测试银行卡数据
└── DatabaseInitializer.initialize_all()
    ├── 创建 transferInfo 表
    ├── 创建查询视图
    ├── 创建余额变更触发器
    └── 创建转账存储过程
```

## 详细使用步骤

### 环境准备

1. **安装Python环境**
   ```bash
   # 确保Python 3.7+已安装
   python --version
   ```

2. **安装MySQL数据库**
   - 下载MySQL 8.0安装包, 安装包地址 https://dev.mysql.com/downloads/windows/installer/8.0.html
   - 安装时设置root密码为：QAZwsx0823( 根据您的代码设置的密码 )
   - 启动MySQL服务

3. **创建项目数据库**
   ```sql
& "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -u root -pQAZwsx0823 -e "CREATE DATABASE IF NOT EXISTS 银行 CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"   ```

### 项目部署

1. **提前下载项目代码**
   ```bash
   # 进入项目目录  ( 要根据你自己存放 python项目的地址 更改）！！！
   cd C:/Users/MSI-NB/PycharmProjects/bankManage
   ```

2. **安装Python依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **配置数据库连接**
   - 打开 `DatabaseConnector.py`
   - 修改第7行的数据库密码：（根据安装mysql的时候设置，这里默认就是 QAZwsx0823）
   ```python
   def __init__(self, host='localhost', user='root', password='你的MySQL密码', database='银行'):
   ```

4. **启动系统**

   **方式一：图形界面版本（推荐）**
   ```bash
   python BankSystemGUI.py
   ```

   **方式二：命令行版本**
   ```bash
   python BankSystem.py
   ```

### 系统使用指南

## GUI图形界面使用说明

### 启动GUI界面
运行 `python BankSystemGUI.py` 后，系统将显示现代化的图形界面：

#### 登录界面
- **管理员登录**：用户名 `admin`，密码 `admin123`
- **客户登录**：使用银行卡号和密码登录

#### GUI界面特性
- **现代化设计**：使用ttk组件，界面美观专业
- **表格显示**：支持数据表格展示，可排序和滚动
- **对话框操作**：所有增删改操作都有专门的对话框
- **右键菜单**：表格支持右键快捷操作
- **实时刷新**：操作后自动刷新数据显示
- **错误提示**：友好的错误提示和确认对话框

#### 管理员GUI功能
1. **客户管理**
   - 查看客户列表（表格形式）
   - 添加新客户（弹出对话框）
   - 编辑客户信息（双击或右键）
   - 删除客户（右键菜单）
   - 搜索客户（关键词搜索）
   - 查看客户银行卡

2. **银行卡管理**
   - 查看所有银行卡（包含客户姓名）
   - 添加新银行卡（选择客户和存款类型）
   - 编辑银行卡信息
   - 删除银行卡
   - 挂失/解挂操作

3. **存款类型管理**
   - 查看存款类型列表
   - 添加新存款类型
   - 编辑存款类型信息
   - 删除存款类型

4. **交易记录查询**
   - 按条件查询交易记录
   - 支持卡号、日期范围筛选
   - 表格显示查询结果

5. **报表管理**
   - 生成各类报表（交易明细、月度汇总等）
   - 快速报表生成（今日、本月、本年）
   - 导出客户和银行卡信息
   - 自动保存为CSV文件

6. **系统统计**
   - 实时显示系统统计信息
   - 客户、银行卡、交易数量统计
   - 今日交易统计
   - 系统总余额统计

#### 客户GUI功能
1. **账户信息显示**
   - 实时显示卡号和余额
   - 账户详细信息展示

2. **银行业务操作**
   - 存款（输入金额对话框）
   - 取款（自动验证余额）
   - 转账（专门的转账对话框）
   - 查询余额（实时更新）
   - 修改密码（密码验证对话框）
   - 银行卡挂失（确认对话框）

3. **交易记录查看**
   - 表格显示个人交易历史
   - 按时间排序显示

## 命令行界面使用说明

#### 管理员操作流程

1. **登录管理员账户**
   - 选择 "1. 管理员登录"
   - 用户名：admin
   - 密码：admin123

2. **客户信息管理**
   ```
   管理员菜单 → 1. 客户信息管理
   ├── 1. 添加客户    # 新增客户信息
   ├── 2. 查询客户    # 查看所有客户
   ├── 3. 修改客户信息 # 更新客户资料
   ├── 4. 删除客户    # 删除客户记录
   └── 5. 搜索客户    # 按关键词搜索
   ```

3. **银行卡管理**
   ```
   管理员菜单 → 2. 银行卡管理
   ├── 1. 添加银行卡   # 为客户开卡
   ├── 2. 查询银行卡   # 查看所有银行卡
   ├── 3. 修改银行卡信息 # 更新卡信息
   ├── 4. 删除银行卡   # 销卡操作
   └── 5. 银行卡挂失   # 挂失处理
   ```

4. **报表统计**
   ```
   管理员菜单 → 5. 报表统计
   ├── 1. 生成交易明细报表  # 导出CSV
   ├── 2. 生成月度汇总报表  # 按月统计
   ├── 3. 生成年度汇总报表  # 按年统计
   ├── 4. 生成账户统计报表  # 账户概览
   ├── 5. 银行整体统计     # 系统总览
   └── 6. 存款类型统计报表  # 产品统计
   ```

#### 客户操作流程

1. **登录客户账户**
   - 选择 "2. 客户登录"
   - 银行卡号：1010357600000001-1010357600000005
   - 密码：888888

2. **基础银行业务**
   ```
   客户菜单 → 选择操作
   ├── 1. 存款      # 向账户存入资金
   ├── 2. 取款      # 从账户取出资金
   ├── 3. 转账      # 向其他账户转账
   ├── 4. 查询余额   # 查看当前余额
   ├── 5. 挂失      # 银行卡挂失
   ├── 6. 修改密码   # 更改登录密码
   └── 7. 查看交易记录 # 查看历史交易
   ```

3. **转账操作示例**
   ```
   1. 选择 "3. 转账"
   2. 输入转入银行卡号：1010357600000002
   3. 输入转账金额：200
   4. 输入备注信息：测试转账
   5. 系统自动验证余额并执行转账
   6. 显示转账结果和更新后余额
   ```

### 测试数据

系统自动创建以下测试数据：

**客户信息**
| ID | 姓名 | 身份证号 | 电话 | 地址 |
|----|------|----------|------|------|
| 1 | John | 110000000000000001 | 13900000001 | 江苏省南京市 |
| 2 | Jane | 110000000000000002 | 13900000002 | - |
| 3 | Michael | 110000000000000003 | 13900000003 | - |
| 4 | Emily | 110000000000000004 | 13900000004 | - |
| 5 | David | 110000000000000005 | 13900000005 | - |

**银行卡信息**
| 卡号 | 客户 | 余额 | 存款类型 |
|------|------|------|----------|
| 1010357600000001 | John | 1000元 | 活期 |
| 1010357600000002 | Jane | 1元 | 整存整取1年 |
| 1010357600000003 | Michael | 1元 | 整存整取1年 |
| 1010357600000004 | Emily | 1元 | 整存整取1年 |
| 1010357600000005 | David | 500元 | 整存整取2年 |

## 功能特性

### 核心业务功能
- **客户管理**：完整的客户信息CRUD操作
- **银行卡管理**：开卡、销卡、挂失、密码管理
- **存取款业务**：实时余额更新，自动交易记录
- **转账功能**：安全的跨账户资金转移
- **交易查询**：详细的交易历史记录

### 技术特性
- **现代化GUI界面**：基于tkinter的专业图形界面
- **双界面支持**：同时提供GUI和命令行两种操作方式
- **触发器自动化**：余额变更自动记录交易信息
- **存储过程**：转账事务处理，保证数据一致性
- **数据库视图**：优化复杂查询，提升性能
- **报表导出**：支持CSV格式的数据导出
- **错误处理**：完善的异常处理和用户提示
- **实时数据**：GUI界面支持实时数据刷新
- **用户友好**：直观的操作界面和友好的提示信息

### 注意原来的代码里面，也就没有额外实现了

 **管理员账户**

精确查询：
客户信息：已实现 (按客户ID)。
银行卡信息：已实现 (按卡号，按客户ID查其所有卡)。
存款业务信息：已实现 (按存款类型ID)。
模糊查询：
客户信息：已实现 (按姓名、电话、身份证号)。
银行卡信息：未实现。
存款业务信息：未实现。
范围查询：
客户信息：未实现。
银行卡信息：未实现。
存款业务信息： 未直接实现




